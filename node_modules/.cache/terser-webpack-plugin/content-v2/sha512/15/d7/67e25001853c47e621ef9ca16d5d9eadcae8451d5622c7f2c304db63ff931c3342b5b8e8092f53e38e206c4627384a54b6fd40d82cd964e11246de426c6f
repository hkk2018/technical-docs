{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{222:function(e,t,r){\"use strict\";r.r(t);var a=r(0),s=Object(a.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":e.$parent.slotKey}},[r(\"h1\",{attrs:{id:\"sql-server語法\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#sql-server語法\"}},[e._v(\"#\")]),e._v(\" Sql Server語法\")]),e._v(\" \"),r(\"h2\",{attrs:{id:\"抓入表格\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#抓入表格\"}},[e._v(\"#\")]),e._v(\" 抓入表格\")]),e._v(\" \"),r(\"pre\",[r(\"code\",[e._v(\"SELECT * INTO #temp;\\nINSERT INTO #temp SELECT _table\\n\")])]),e._v(\" \"),r(\"h2\",{attrs:{id:\"drop-temp-table\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#drop-temp-table\"}},[e._v(\"#\")]),e._v(\" Drop temp table\")]),e._v(\" \"),r(\"pre\",[r(\"code\",[e._v(\"IF object_id('tempdb..#temp') IS NOT NULL\\nBEGIN\\nDROP TABLE #temp\\nEND\\n\")])]),e._v(\" \"),r(\"h2\",{attrs:{id:\"從sp取得result-table\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#從sp取得result-table\"}},[e._v(\"#\")]),e._v(\" 從SP取得result table\")]),e._v(\" \"),r(\"p\",[r(\"a\",{attrs:{href:\"https://stackoverflow.com/questions/653714/insert-results-of-a-stored-procedure-into-a-temporary-table\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"ref\"),r(\"OutboundLink\")],1)]),e._v(\" \"),r(\"ol\",[r(\"li\",[r(\"p\",[e._v(\"使用SELECT INTO (不用宣告table) 要 Linking Servers。\")])]),e._v(\" \"),r(\"li\",[r(\"p\",[e._v(\"用INSERT INTO但要宣告 table。（插入實體表則不用宣告）\")]),e._v(\" \"),r(\"p\",[e._v(\"CREATE TABLE #temp\\n(\\nCOL1 INT,\\nCOL2 INT\\n)\\nINSERT INTO #temp Exec Sp'Params'\")])])]),e._v(\" \"),r(\"p\",[e._v(\"因此寫成table-valued函數是一種解法\")]),e._v(\" \"),r(\"pre\",[r(\"code\",[e._v(\"SELECT TOP(0) * INTO #temp FROM table-valued-func(@gameId,DEFAULT);\\n\")])]),e._v(\" \"),r(\"h2\",{attrs:{id:\"inserted-id\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#inserted-id\"}},[e._v(\"#\")]),e._v(\" Inserted.id\")]),e._v(\" \"),r(\"h3\",{attrs:{id:\"get-in-c\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#get-in-c\"}},[e._v(\"#\")]),e._v(\" Get in C#\")]),e._v(\" \"),r(\"pre\",[r(\"code\",[e._v(\"INSERT INTO MyTable(Name, Address, PhoneNo)\\nOUTPUT INSERTED.ID\\nVALUES ('Yatrix', '1234 Address Stuff', '1112223333')\\nDECLARE @OutputTbl TABLE (ID INT)\\n\")])]),e._v(\" \"),r(\"p\",[e._v(\"PS: by .ExecuteScalar()\")]),e._v(\" \"),r(\"h3\",{attrs:{id:\"get-in-sql\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#get-in-sql\"}},[e._v(\"#\")]),e._v(\" Get in sql\")]),e._v(\" \"),r(\"pre\",[r(\"code\",[e._v(\"DECLARE @OutputTbl TABLE (ID INT)\\n\\nINSERT INTO MyTable(Name, Address, PhoneNo)\\nOUTPUT INSERTED.ID INTO @OutputTbl(ID)\\nVALUES ('Yatrix', '1234 Address Stuff', '1112223333')\\n\")])]),e._v(\" \"),r(\"p\",[r(\"a\",{attrs:{href:\"https://stackoverflow.com/questions/10999396/how-do-i-use-an-insert-statements-output-clause-to-get-the-identity-value/10999467#10999467\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"ref\"),r(\"OutboundLink\")],1)])])}),[],!1,null,null,null);t.default=s.exports}}]);","extractedComments":[]}